<div class="search-page">
  <div class="search-page__header">
    <div class="search-page__header-inner">
      {%- if section.settings.eyebrow_text != blank -%}
        <span class="eyebrow">{{ section.settings.eyebrow_text }}</span>
      {%- endif -%}
      <h1 class="search-page__title">{{ section.settings.page_title }}</h1>

      <form action="{{ routes.search_url }}" method="get" role="search" class="search-page__form">
        <input type="hidden" name="type" value="product,article,page">
        <div class="search-page__input-wrap">
          <input
            type="search"
            name="q"
            value="{{ search.terms | escape }}"
            placeholder="{{ section.settings.input_placeholder }}"
            class="search-page__input"
            aria-label="{{ section.settings.page_title }}"
            autocomplete="off"
          >
          <button type="submit" class="search-page__submit btn btn--primary" aria-label="{{ 'search.submit' | t }}">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
              <circle cx="11" cy="11" r="8"/>
              <path stroke-linecap="round" d="m21 21-4.35-4.35"/>
            </svg>
            <span>{{ section.settings.button_text }}</span>
          </button>
        </div>
      </form>
    </div>
  </div>

  {%- if search.performed -%}
    <div class="search-page__results">
      <div class="search-page__results-inner">
        {%- if search.results_count == 0 -%}
          <div class="search-no-results">
            <p class="search-no-results__message">
              {{ section.settings.no_results_prefix }}
              <span class="search-no-results__term">&ldquo;{{ search.terms | escape }}&rdquo;</span>
            </p>
            <p class="search-no-results__suggestion">{{ section.settings.no_results_suggestion }}</p>
            <a href="{{ routes.all_products_collection_url }}" class="btn btn--secondary search-no-results__btn">
              {{ section.settings.browse_all_text }}
            </a>
          </div>

        {%- else -%}
          <p class="search-page__count">
            {{ search.results_count }}
            {{ search.results_count | pluralize: section.settings.result_singular, section.settings.result_plural }}
            &mdash; &ldquo;{{ search.terms | escape }}&rdquo;
          </p>

          {% paginate search.results by section.settings.results_per_page %}
            <div class="search-results-grid">
              {%- for result in search.results -%}
                {%- assign featured_image = result.featured_image | default: result.image -%}
                <article class="product-card fade-up" data-delay="{{ forloop.index | modulo: 4 | plus: 1 }}">
                  <a href="{{ result.url }}" class="product-card__link" aria-label="{{ result.title | escape }}">
                    <div class="product-card__media">
                      {%- if featured_image -%}
                        {{
                          featured_image
                          | image_url: width: 600
                          | image_tag:
                            loading: 'lazy',
                            sizes: '(max-width: 768px) 50vw, (max-width: 1024px) 33vw, 25vw',
                            alt: featured_image.alt | default: result.title
                        }}
                      {%- else -%}
                        {{ 'product-1' | placeholder_svg_tag: 'product-card__placeholder' }}
                      {%- endif -%}
                    </div>
                    <div class="product-card__overlay"></div>
                    <div class="product-card__info">
                      <h3 class="product-card__title">{{ result.title }}</h3>
                      {%- if result.price -%}
                        <p class="product-card__price">
                          {%- if result.compare_at_price > result.price -%}
                            <s class="product-card__compare">{{ result.compare_at_price | money }}</s>
                          {%- endif -%}
                          {{ result.price | money }}
                        </p>
                      {%- endif -%}
                      <span class="product-card__cta" aria-hidden="true">{{ section.settings.card_cta_text }} &rarr;</span>
                    </div>
                  </a>
                </article>
              {%- endfor -%}
            </div>

            {%- if paginate.pages > 1 -%}
              <div class="search-page__pagination pagination">
                {{ paginate | default_pagination }}
              </div>
            {%- endif -%}
          {% endpaginate %}
        {%- endif -%}
      </div>
    </div>
  {%- endif -%}
</div>

{% stylesheet %}
  .search-page {
    background: var(--color-black);
    min-height: calc(80vh - var(--header-total-height));
  }

  /* Header / search form */
  .search-page__header {
    background: var(--color-charcoal);
    padding: 64px var(--page-margin) 56px;
    text-align: center;
  }

  .search-page__header-inner {
    max-width: 640px;
    margin: 0 auto;
  }

  .search-page__title {
    font-family: var(--font-heading);
    font-size: clamp(32px, 5vw, 56px);
    color: var(--color-white);
    line-height: 1;
    margin-bottom: 32px;
  }

  .search-page__form {
    width: 100%;
  }

  .search-page__input-wrap {
    display: flex;
    align-items: stretch;
    gap: 0;
    border: 1px solid rgba(200, 169, 110, 0.4);
    overflow: hidden;
  }

  .search-page__input {
    flex: 1;
    background: rgba(255, 255, 255, 0.05);
    border: none;
    color: var(--color-white);
    font-family: var(--font-body);
    font-size: 17px;
    padding: 16px 20px;
    outline: none;
  }

  .search-page__input::placeholder {
    color: rgba(200, 169, 110, 0.4);
  }

  .search-page__submit {
    clip-path: none;
    border-radius: 0;
    padding: 14px 24px;
    gap: 8px;
    flex-shrink: 0;
  }

  .search-page__submit svg {
    width: 18px;
    height: 18px;
  }

  /* Results */
  .search-page__results {
    padding: 48px var(--page-margin) 80px;
  }

  .search-page__results-inner {
    max-width: var(--page-width);
    margin: 0 auto;
  }

  .search-page__count {
    font-family: var(--font-label);
    font-size: 13px;
    font-weight: 500;
    letter-spacing: 2px;
    text-transform: uppercase;
    color: rgba(200, 169, 110, 0.6);
    margin-bottom: 32px;
  }

  .search-results-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 3px;
  }

  .search-results-grid .product-card {
    min-height: 300px;
  }

  /* No results */
  .search-no-results {
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    padding: 60px 0;
    gap: 16px;
  }

  .search-no-results__message {
    font-family: var(--font-body);
    font-size: 18px;
    color: var(--color-tan-light);
    line-height: 1.6;
  }

  .search-no-results__term {
    color: var(--color-tan);
  }

  .search-no-results__suggestion {
    font-family: var(--font-body);
    font-size: 15px;
    color: rgba(200, 169, 110, 0.55);
    max-width: 400px;
    line-height: 1.6;
  }

  .search-no-results__btn {
    margin-top: 8px;
    font-size: 13px;
  }

  @media (max-width: 1024px) {
    .search-results-grid { grid-template-columns: repeat(3, 1fr); }
  }

  @media (max-width: 768px) {
    .search-page__header { padding: 48px var(--page-margin) 40px; }
    .search-page__submit span { display: none; }
    .search-results-grid { grid-template-columns: repeat(2, 1fr); }
    .search-results-grid .product-card { min-height: 240px; }
  }

  @media (max-width: 480px) {
    .search-page__input-wrap { flex-direction: column; }
    .search-page__submit { width: 100%; justify-content: center; }
    .search-page__submit span { display: inline; }
  }
{% endstylesheet %}

{% schema %}
{
  "name": "Search",
  "settings": [
    {
      "type": "header",
      "content": "Labels"
    },
    {
      "type": "text",
      "id": "eyebrow_text",
      "label": "Eyebrow label",
      "default": "// Find Your Gear"
    },
    {
      "type": "text",
      "id": "page_title",
      "label": "Page title",
      "default": "Search"
    },
    {
      "type": "text",
      "id": "input_placeholder",
      "label": "Input placeholder",
      "default": "Search for gear, apparel, and more..."
    },
    {
      "type": "text",
      "id": "button_text",
      "label": "Search button text",
      "default": "Search"
    },
    {
      "type": "header",
      "content": "Results"
    },
    {
      "type": "range",
      "id": "results_per_page",
      "label": "Results per page",
      "min": 8,
      "max": 24,
      "step": 4,
      "default": 16
    },
    {
      "type": "text",
      "id": "result_singular",
      "label": "Result singular (e.g. result)",
      "default": "result"
    },
    {
      "type": "text",
      "id": "result_plural",
      "label": "Result plural (e.g. results)",
      "default": "results"
    },
    {
      "type": "text",
      "id": "card_cta_text",
      "label": "Card hover CTA text",
      "default": "View"
    },
    {
      "type": "header",
      "content": "No results"
    },
    {
      "type": "text",
      "id": "no_results_prefix",
      "label": "No results prefix text",
      "default": "No results found for"
    },
    {
      "type": "text",
      "id": "no_results_suggestion",
      "label": "Suggestion text",
      "default": "Try a different search term, or browse our full collection below."
    },
    {
      "type": "text",
      "id": "browse_all_text",
      "label": "Browse all link text",
      "default": "Browse All Products"
    }
  ]
}
{% endschema %}
